# Influence of color correction on pathology detection in Capsule Endoscopy
This is an official implementation for CVPR2022 paper ["nfluence of color correction on pathology detection in Capsule Endoscopy"](https://xx.pdf). 
It includes the code for Object Detection tasks using Retinanet and YOLOv5 on the SEE-AI Capsule Endoscopy dataset.
(1) Retinant and YOLOv5 benchmarked on the original SEE-AI Dataset (R_OrigD)
(2) Retinant and YOLOv5 benchmarked on the Color Checker Corrected version of SEE-AI Dataset (R_CCD)
(3) Retinant and YOLOv5 benchmarked on the Colon Checker Corrected version of the SEE-AI Dataset (R_CCCD).
The performance of the two SOA models Retinanet and YOLOv5 on the three datasets is reported in this repo.


## Dataset Preparation

### For Retinanet Model:
```
dataset/
  csv/
    class_list.csv
    train_annots.csv
    val_annots.csv
  images/
    training/
    validation/
```
You can download the corresponding dataset for each of the three experiment from the following link:
https://www.kaggle.com/datasets/emmanuelagosou/see-ai-dataset-r-origd-retinanet
https://www.kaggle.com/datasets/emmanuelagosou/see-ai-dataset-r-ccd-retinanet


### For YOLOV5 Model:
```
data/
  images/
    training/
    validation/
  labels/
    training/
    validation/
   
```

## Training Retinanet Model

```

```
## Validation for Retinanet Model

```

```
## Testing Retinanet Model

```

```


## Training YOLOv5 Model

```

```
## Validation for YOLOv5 Model

```

```
## Testing YOLOv5 Model

```

```
## Performance metrics
```

```

## False Positive Results 
```

```

## Bounding Boxes Areas Results 
```

```

## Some Detection Results 
```

```


<table border="0" width="800">
<tr>
	<td width="25%" align="center"> <b> Models </b> </td>
	<td width="25%" align="center"> <b> Datasets </b> </td>
	<td width="15%" align="center"> <b> Labels </b> </td>
	<td width="25%" align="center"> <b> Supervision(mAP) </b> </td>
	<td width="25%" align="center"> <b> Ours(mAP) </b> </td>
</tr>
	
<tr>
	<td width="25" align="center" rowspan="9"> Res50-FPN</td>
	<td width="25%" align="center" rowspan="5"> COCO </td>
	<td width="15%" align="center"> 1% </td>
	<td width="25%" align="center" rowspan="5"> 37.63 </td>
	<td width="25%" align="center"> 22.20 </td>
</tr>
<tr>
	<td width="15%" align="center"> 2% </td>
	<td width="25%" align="center"> 24.99 </td>
</tr>
<tr>
	<td width="15%" align="center"> 5% </td>
	<td width="25%" align="center"> 30.07 </td>
</tr>
<tr>
	<td width="15%" align="center"> 10% </td>
	<td width="25%" align="center"> 32.58 </td>
</tr>
<tr>
	<td width="15%" align="center"> 20% </td>
	<td width="25%" align="center"> 35.49 </td>
</tr>

<tr>
	<td width="25%" align="center" rowspan="3"> VOC07+12 </td>
	<td width="15%" align="center"> 5% </td>
	<td width="25%" align="center" rowspan="3"> 48.62 </td>
	<td width="25%" align="center"> 41.85 </td>
</tr>
<tr>
	<td width="15%" align="center"> 10% </td>
	<td width="25%" align="center"> 46.77 </td>
</tr>
<tr>
	<td width="15%" align="center"> 15% </td>
	<td width="25%" align="center"> 49.73 </td>
</tr>
	
<tr>
	<td width="25%" align="center"> SODA </td>
	<td width="15%" align="center"> 10% </td>
	<td width="25%" align="center"> 34.52 </td>
	<td width="25%" align="center"> 33.32 </td>
</tr>
</table>
	
## Citing the paper

If you find this work useful in your research, please consider citing:

```
@InProceedings{,
}   
```

## License

This work is released under the [xxxx](LICENSE).

## Acknowledgement
-   [Retinanet](https://github.com/yhenon/pytorch-retinanet)
-   [YOLOv5](https://github.com/ultralytics/yolov5/tree/master)
-   ```
@inproceedings{watine2023enhancement,
  title={Enhancement of Colour Reproduction for Capsule Endoscopy Images},
  author={Watine, L{\'e}o and Floor, P{\aa}l Anders and Pedersen, Marius and Nussbaum, Peter and Ahmad, Bilal and Hovde, {\O}istein},
  booktitle={2023 11th European Workshop on Visual Information Processing (EUVIP)},
  pages={1--6},
  year={2023},
  organization={IEEE}
```
}

